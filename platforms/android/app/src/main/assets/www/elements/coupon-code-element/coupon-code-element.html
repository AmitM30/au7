  <!--
SKU details element

Example:
    <coupon-code-element></coupon-code-element>
@demo
-->

<dom-module id="coupon-code-element">

  <style>
    :host {
      display: block;
      box-sizing: border-box;
    }
  </style>

  <template>
    <form novalidate onsubmit="return false;">
      <template is="dom-if" if="[[ !code ]]">
        <input is="iron-input" name="couponCode" type="text" placeholder="[[ _translate('Enter coupon/voucher') ]]" bind-value="{{ coupon }}" autocomplete="off" />
        <button class="core-block-cta core-block-cta-tertiary" type="submit">[[ _translate('Apply') ]]<paper-ripple></paper-ripple></button>
      </template>
      <template is="dom-if" if="[[ code ]]">
        <span class="applied-coupon-code">[[ _translate('Coupon') ]]: <strong>[[ coupon ]]</strong></span>
        <button class="core-block-cta core-block-cta-support" on-tap="_removeCoupon" type="button">[[ _translate('Remove') ]]</button>
      </template>
    </form>
  </template>

</dom-module>

<script>

  Polymer({
    is: 'coupon-code-element',

    listeners: {
      'submit': '_handleSubmit'
    },

    properties: {

      code: {
        type: String,
        notify: true
      },

      /**
       * Application context
       */
      ctx: {
        type: Object
      }
    },

    // Element Lifecycle
    attached: function () {
      this.coupon = this.code;
    },

    _handleSubmit: function (event) {
      event.stopPropagation();
      if (event.type === 'submit' && this.coupon) {
        this.fire('apply-coupon', { code: this.coupon });
      }
    },

    _removeCoupon: function (event) {
      event.stopPropagation();
      this.fire('remove-coupon');
    },

    _translate: function (key) {
      return window.translate(key);
    }
  });

</script>
